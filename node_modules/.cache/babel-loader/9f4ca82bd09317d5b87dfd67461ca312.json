{"ast":null,"code":"import _regeneratorRuntime from\"/home/groves/code/pp-react/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/groves/code/pp-react/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/groves/code/pp-react/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{React,useState}from\"react\";import{Link,useHistory}from\"react-router-dom\";import\"../css/Login.css\";import dog from\"../assets/images/dog.png\";import{useDispatch,useSelector}from\"react-redux\";import{getUserData}from\"../actions/profile-actions\";import{makeStyles}from\"@material-ui/core/styles\";import Alert from\"@material-ui/lab/Alert\";import{dbReservations}from\"../actions/db-reservations-actions\";import{getLoginStatus}from\"../actions/login-actions\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useStyles=makeStyles(function(theme){return{root:{width:\"30%\",marginTop:\"30px\",\"& > * + *\":{marginTop:theme.spacing(2)}}};});export default function Login(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),loginMessage=_useState6[0],setLoginMessage=_useState6[1];var loginStatus=useSelector(function(state){return state.loginStatus;});var profileData=useSelector(function(state){return state.profileData;});var history=useHistory();var dispatch=useDispatch();var classes=useStyles();var sendForm=function sendForm(e){e.preventDefault();fetch(\"https://shrouded-cove-47330.herokuapp.com/api/users/login\",{method:\"POST\",body:JSON.stringify({email:email,password:password}),credentials:\"include\",headers:{\"Content-Type\":\"application/json\"}}).then(function(res){return res.json();}).then(function(data){if(data.message){setLoginMessage(data.message);setPassword(\"\");history.push(\"/login\");}else{if(loginStatus&&loginStatus.length>1){getUserData(dispatch,data);getReservationsData();getLoginStatus(dispatch,\"\");history.goBack();}else{getUserData(dispatch,data);getReservationsData();getLoginStatus(dispatch,\"\");history.push(\"/\");}}});return false;};var getReservationsData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,parsedData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"https://shrouded-cove-47330.herokuapp.com/api/reservations/\".concat(profileData.id),{method:\"GET\"});case 2:response=_context.sent;_context.next=5;return response.json();case 5:parsedData=_context.sent;dbReservations(dispatch,parsedData);case 7:case\"end\":return _context.stop();}}},_callee);}));return function getReservationsData(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"div\",{id:\"login-section\",children:[loginStatus?/*#__PURE__*/_jsx(\"div\",{className:classes.root,children:/*#__PURE__*/_jsx(Alert,{severity:\"error\",children:\"Please login to make a reservation      \"})}):/*#__PURE__*/_jsx(\"div\",{}),loginMessage?/*#__PURE__*/_jsx(\"div\",{id:\"login-toast\",className:classes.root,children:/*#__PURE__*/_jsx(Alert,{severity:\"error\",children:\"Unable to login. Please check your credentials and try again!\"})}):/*#__PURE__*/_jsx(\"div\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"form\",{className:\"login-form\",onSubmit:function onSubmit(e){return sendForm(e);},children:[/*#__PURE__*/_jsx(\"h1\",{className:\"login-header\",children:\"Log In to Find Parking\"}),/*#__PURE__*/_jsx(\"img\",{id:\"dog-icon\",src:dog,alt:\"dog\"}),/*#__PURE__*/_jsx(\"input\",{className:\"login-input-1\",type:\"email\",placeholder:\"Email\",onChange:function onChange(e){return setEmail(e.target.value);},value:email,required:true}),/*#__PURE__*/_jsx(\"input\",{className:\"login-input-2\",type:\"password\",placeholder:\"Password\",onChange:function onChange(e){return setPassword(e.target.value);},value:password,required:true}),/*#__PURE__*/_jsx(\"button\",{className:\"login-button\",type:\"submit\",children:\"Log In\"}),/*#__PURE__*/_jsx(Link,{className:\"login-link\",to:\"/RegisterUser\",children:/*#__PURE__*/_jsx(\"p\",{children:\"Not signed up? Click here to make an account!\"})})]})]})});}","map":{"version":3,"sources":["/home/groves/code/pp-react/src/components/Login.jsx"],"names":["React","useState","Link","useHistory","dog","useDispatch","useSelector","getUserData","makeStyles","Alert","dbReservations","getLoginStatus","useStyles","theme","root","width","marginTop","spacing","Login","email","setEmail","password","setPassword","loginMessage","setLoginMessage","loginStatus","state","profileData","history","dispatch","classes","sendForm","e","preventDefault","fetch","method","body","JSON","stringify","credentials","headers","then","res","json","data","message","push","length","getReservationsData","goBack","id","response","parsedData","target","value"],"mappings":"oUAAA,OAASA,KAAT,CAAgBC,QAAhB,KAA+B,OAA/B,CACA,OAASC,IAAT,CAAeC,UAAf,KAAiC,kBAAjC,CACA,MAAO,kBAAP,CACA,MAAOC,CAAAA,GAAP,KAAgB,0BAAhB,CACA,OAASC,WAAT,CAAsBC,WAAtB,KAAyC,aAAzC,CACA,OAASC,WAAT,KAA4B,4BAA5B,CACA,OAASC,UAAT,KAA2B,0BAA3B,CACA,MAAOC,CAAAA,KAAP,KAAkB,wBAAlB,CACA,OAASC,cAAT,KAA+B,oCAA/B,CACA,OAASC,cAAT,KAA+B,0BAA/B,C,wFAEA,GAAMC,CAAAA,SAAS,CAAGJ,UAAU,CAAC,SAACK,KAAD,QAAY,CACxCC,IAAI,CAAE,CACLC,KAAK,CAAE,KADF,CAELC,SAAS,CAAE,MAFN,CAGL,YAAa,CACZA,SAAS,CAAEH,KAAK,CAACI,OAAN,CAAc,CAAd,CADC,CAHR,CADkC,CAAZ,EAAD,CAA5B,CAUA,cAAe,SAASC,CAAAA,KAAT,EAAiB,CAC/B,cAA0BjB,QAAQ,CAAC,EAAD,CAAlC,wCAAOkB,KAAP,eAAcC,QAAd,eACA,eAAgCnB,QAAQ,CAAC,EAAD,CAAxC,yCAAOoB,QAAP,eAAiBC,WAAjB,eACA,eAAwCrB,QAAQ,CAAC,EAAD,CAAhD,yCAAOsB,YAAP,eAAqBC,eAArB,eACA,GAAMC,CAAAA,WAAW,CAAGnB,WAAW,CAAC,SAACoB,KAAD,QAAWA,CAAAA,KAAK,CAACD,WAAjB,EAAD,CAA/B,CACA,GAAME,CAAAA,WAAW,CAAGrB,WAAW,CAAC,SAACoB,KAAD,QAAWA,CAAAA,KAAK,CAACC,WAAjB,EAAD,CAA/B,CACA,GAAMC,CAAAA,OAAO,CAAGzB,UAAU,EAA1B,CACA,GAAM0B,CAAAA,QAAQ,CAAGxB,WAAW,EAA5B,CACA,GAAMyB,CAAAA,OAAO,CAAGlB,SAAS,EAAzB,CAEA,GAAMmB,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACC,CAAD,CAAO,CACvBA,CAAC,CAACC,cAAF,GACAC,KAAK,CAAC,2DAAD,CAA8D,CAClEC,MAAM,CAAE,MAD0D,CAElEC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAe,CAAEnB,KAAK,CAALA,KAAF,CAASE,QAAQ,CAARA,QAAT,CAAf,CAF4D,CAGlEkB,WAAW,CAAE,SAHqD,CAIlEC,OAAO,CAAE,CACR,eAAgB,kBADR,CAJyD,CAA9D,CAAL,CAQEC,IARF,CAQO,SAACC,GAAD,QAASA,CAAAA,GAAG,CAACC,IAAJ,EAAT,EARP,EASEF,IATF,CASO,SAACG,IAAD,CAAU,CACf,GAAIA,IAAI,CAACC,OAAT,CAAkB,CACjBrB,eAAe,CAACoB,IAAI,CAACC,OAAN,CAAf,CACAvB,WAAW,CAAC,EAAD,CAAX,CACAM,OAAO,CAACkB,IAAR,CAAa,QAAb,EACA,CAJD,IAIO,CACN,GAAIrB,WAAW,EAAIA,WAAW,CAACsB,MAAZ,CAAqB,CAAxC,CAA2C,CAC3CxC,WAAW,CAACsB,QAAD,CAAWe,IAAX,CAAX,CACAI,mBAAmB,GACnBrC,cAAc,CAACkB,QAAD,CAAW,EAAX,CAAd,CACAD,OAAO,CAACqB,MAAR,GACC,CALD,IAKO,CACP1C,WAAW,CAACsB,QAAD,CAAWe,IAAX,CAAX,CACAI,mBAAmB,GACnBrC,cAAc,CAACkB,QAAD,CAAW,EAAX,CAAd,CACAD,OAAO,CAACkB,IAAR,CAAa,GAAb,EACA,CAAC,CAAC,CAzBL,EA0BA,MAAO,MAAP,CACA,CA7BD,CA+BA,GAAME,CAAAA,mBAAmB,0FAAG,iLACJd,CAAAA,KAAK,sEAA+DP,WAAW,CAACuB,EAA3E,EAAiF,CAC5Gf,MAAM,CAAE,KADoG,CAAjF,CADD,QACrBgB,QADqB,qCAIFA,CAAAA,QAAQ,CAACR,IAAT,EAJE,QAIrBS,UAJqB,eAK3B1C,cAAc,CAACmB,QAAD,CAAWuB,UAAX,CAAd,CAL2B,sDAAH,kBAAnBJ,CAAAA,mBAAmB,0CAAzB,CAQA,mBACC,kCACC,aAAK,EAAE,CAAC,eAAR,WACCvB,WAAW,cACV,YAAK,SAAS,CAAEK,OAAO,CAAChB,IAAxB,uBACC,KAAC,KAAD,EAAO,QAAQ,CAAC,OAAhB,sDADD,EADU,cAMV,cAPF,CASES,YAAY,cACZ,YAAK,EAAE,CAAC,aAAR,CAAsB,SAAS,CAAEO,OAAO,CAAChB,IAAzC,uBACC,KAAC,KAAD,EAAO,QAAQ,CAAC,OAAhB,2EADD,EADY,cAOZ,cAhBF,cAkBC,aAlBD,cAmBC,cAAM,SAAS,CAAC,YAAhB,CAA6B,QAAQ,CAAE,kBAACkB,CAAD,QAAOD,CAAAA,QAAQ,CAACC,CAAD,CAAf,EAAvC,wBACC,WAAI,SAAS,CAAC,cAAd,oCADD,cAEC,YAAK,EAAE,CAAC,UAAR,CAAmB,GAAG,CAAE5B,GAAxB,CAA6B,GAAG,CAAC,KAAjC,EAFD,cAGC,cACC,SAAS,CAAC,eADX,CAEC,IAAI,CAAC,OAFN,CAGC,WAAW,CAAC,OAHb,CAIC,QAAQ,CAAE,kBAAC4B,CAAD,QAAOZ,CAAAA,QAAQ,CAACY,CAAC,CAACqB,MAAF,CAASC,KAAV,CAAf,EAJX,CAKC,KAAK,CAAEnC,KALR,CAMC,QAAQ,KANT,EAHD,cAWC,cACC,SAAS,CAAC,eADX,CAEC,IAAI,CAAC,UAFN,CAGC,WAAW,CAAC,UAHb,CAIC,QAAQ,CAAE,kBAACa,CAAD,QAAOV,CAAAA,WAAW,CAACU,CAAC,CAACqB,MAAF,CAASC,KAAV,CAAlB,EAJX,CAKC,KAAK,CAAEjC,QALR,CAMC,QAAQ,KANT,EAXD,cAmBC,eAAQ,SAAS,CAAC,cAAlB,CAAiC,IAAI,CAAC,QAAtC,oBAnBD,cAsBC,KAAC,IAAD,EAAM,SAAS,CAAC,YAAhB,CAA6B,EAAE,CAAC,eAAhC,uBACC,oEADD,EAtBD,GAnBD,GADD,EADD,CAkDA","sourcesContent":["import { React, useState} from \"react\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport \"../css/Login.css\";\nimport dog from \"../assets/images/dog.png\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { getUserData } from \"../actions/profile-actions\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Alert from \"@material-ui/lab/Alert\";\nimport { dbReservations } from \"../actions/db-reservations-actions\";\nimport { getLoginStatus } from \"../actions/login-actions\";\n\nconst useStyles = makeStyles((theme) => ({\n\troot: {\n\t\twidth: \"30%\",\n\t\tmarginTop: \"30px\",\n\t\t\"& > * + *\": {\n\t\t\tmarginTop: theme.spacing(2),\n\t\t},\n\t},\n}));\n\nexport default function Login() {\n\tconst [email, setEmail] = useState(\"\");\n\tconst [password, setPassword] = useState(\"\");\n\tconst [loginMessage, setLoginMessage] = useState(\"\");\n\tconst loginStatus = useSelector((state) => state.loginStatus)\n\tconst profileData = useSelector((state) => state.profileData);\n\tconst history = useHistory();\n\tconst dispatch = useDispatch();\n\tconst classes = useStyles();\n\n\tconst sendForm = (e) => {\n\t\te.preventDefault();\n\t\tfetch(\"https://shrouded-cove-47330.herokuapp.com/api/users/login\", {\n\t\t\tmethod: \"POST\",\n\t\t\tbody: JSON.stringify({ email, password }),\n\t\t\tcredentials: \"include\",\n\t\t\theaders: {\n\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t},\n\t\t})\n\t\t\t.then((res) => res.json())\n\t\t\t.then((data) => {\n\t\t\t\tif (data.message) {\n\t\t\t\t\tsetLoginMessage(data.message);\n\t\t\t\t\tsetPassword(\"\");\n\t\t\t\t\thistory.push(\"/login\");\n\t\t\t\t} else {\n\t\t\t\t\tif (loginStatus && loginStatus.length > 1) {\n\t\t\t\t\tgetUserData(dispatch, data);\n\t\t\t\t\tgetReservationsData();\n\t\t\t\t\tgetLoginStatus(dispatch, \"\")\n\t\t\t\t\thistory.goBack();\n\t\t\t\t\t} else {\n\t\t\t\t\tgetUserData(dispatch, data);\n\t\t\t\t\tgetReservationsData();\n\t\t\t\t\tgetLoginStatus(dispatch, \"\")\n\t\t\t\t\thistory.push(\"/\");\n\t\t\t\t}}});\n\t\treturn false;\n\t};\n\n\tconst getReservationsData = async () => {\n\t\tconst response = await fetch(`https://shrouded-cove-47330.herokuapp.com/api/reservations/${profileData.id}`, {\n\t\t\tmethod: \"GET\",\n\t\t});\n\t\tconst parsedData = await response.json();\n\t\tdbReservations(dispatch, parsedData);\n\t};\n\n\treturn (\n\t\t<div>\n\t\t\t<div id=\"login-section\">\n\t\t\t{loginStatus ? (\n\t\t\t\t\t<div className={classes.root}>\n\t\t\t\t\t\t<Alert severity=\"error\">\n\t\t\t\t\t\t\tPlease login to make a reservation\t\t\t\t\t\t</Alert>\n\t\t\t\t\t</div>\n\t\t\t\t) : (\n\t\t\t\t\t<div></div>\n\t\t\t\t)}\n\t\t\t\t{loginMessage ? (\n\t\t\t\t\t<div id=\"login-toast\" className={classes.root}>\n\t\t\t\t\t\t<Alert severity=\"error\">\n\t\t\t\t\t\t\tUnable to login. Please check your credentials and try again!\n\t\t\t\t\t\t</Alert>\n\t\t\t\t\t</div>\n\t\t\t\t) : (\n\t\t\t\t\t<div></div>\n\t\t\t\t)}\n\t\t\t\t<br />\n\t\t\t\t<form className=\"login-form\" onSubmit={(e) => sendForm(e)}>\n\t\t\t\t\t<h1 className=\"login-header\">Log In to Find Parking</h1>\n\t\t\t\t\t<img id=\"dog-icon\" src={dog} alt=\"dog\" />\n\t\t\t\t\t<input\n\t\t\t\t\t\tclassName=\"login-input-1\"\n\t\t\t\t\t\ttype=\"email\"\n\t\t\t\t\t\tplaceholder=\"Email\"\n\t\t\t\t\t\tonChange={(e) => setEmail(e.target.value)}\n\t\t\t\t\t\tvalue={email}\n\t\t\t\t\t\trequired\n\t\t\t\t\t/>\n\t\t\t\t\t<input\n\t\t\t\t\t\tclassName=\"login-input-2\"\n\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\tplaceholder=\"Password\"\n\t\t\t\t\t\tonChange={(e) => setPassword(e.target.value)}\n\t\t\t\t\t\tvalue={password}\n\t\t\t\t\t\trequired\n\t\t\t\t\t/>\n\t\t\t\t\t<button className=\"login-button\" type=\"submit\">\n\t\t\t\t\t\tLog In\n\t\t\t\t\t</button>\n\t\t\t\t\t<Link className=\"login-link\" to=\"/RegisterUser\">\n\t\t\t\t\t\t<p>Not signed up? Click here to make an account!</p>\n\t\t\t\t\t</Link>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n"]},"metadata":{},"sourceType":"module"}