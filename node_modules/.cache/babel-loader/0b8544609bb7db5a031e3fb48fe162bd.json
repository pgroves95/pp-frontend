{"ast":null,"code":"var _jsxFileName = \"/home/groves/code/parking-pals/client/src/components/DrivewayResults.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useRef, useEffect, useState } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Paper from \"@material-ui/core/Paper\";\nimport emptyDriveway from \"../assets/images/emptydriveway.png\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport mapboxgl from \"!mapbox-gl\"; // eslint-disable-line import/no-webpack-loader-syntax\n\nimport \"../css/DrivewayResults.css\";\nimport { setSearchCoordinates } from \"../actions/search-actions\";\nimport { dbDriveways } from \"../actions/db-driveways-actions\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nmapboxgl.accessToken = \"pk.eyJ1Ijoid3N2b2JvZGEiLCJhIjoiY2txMTE1cGl2MDVmZzJvcXVibjViMGliaCJ9.13cxlIO8hYUtM1rQuvlbBw\";\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: \"flex\",\n    flexWrap: \"wrap\",\n    \"& > *\": {\n      margin: theme.spacing(1),\n      width: theme.spacing(32),\n      height: theme.spacing(32)\n    },\n    margin: \"auto\"\n  }\n}));\nexport default function DrivewayResults() {\n  _s();\n\n  const searchCoordinates = useSelector(state => state.searchCoordinates);\n  const dbDrivewayList = useSelector(state => state.dbDrivewayList);\n  const [lng, setLng] = useState(-84.4);\n  const [lat, setLat] = useState(33.755);\n  const [zoom, setZoom] = useState(14);\n  const [search, setSearch] = useState(\"\");\n  const dispatch = useDispatch();\n  const classes = useStyles();\n  const history = useHistory();\n\n  const getDrivewayData = async () => {\n    const response = await fetch(\"http://localhost:3001/api/driveways\", {\n      method: \"GET\"\n    });\n    const parsedData = await response.json();\n    dbDriveways(dispatch, parsedData);\n    const allPoints = dbDrivewayList.map(point => ({\n      type: 'Feature',\n      properties: {\n        description: `<strong>${point.address}</strong><p><a href=\"http://www.mtpleasantdc.com/makeitmtpleasant\" target=\"_blank\" title=\"Opens in a new window\">View More</a></p>`,\n        'icon': 'veterinary-15'\n      },\n      geometry: {\n        type: 'Point',\n        coordinates: point.lat_long\n      }\n    }));\n    return allPoints;\n  };\n\n  const getLocation = async () => {\n    const response = await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${search}.json?&access_token=pk.eyJ1Ijoid3N2b2JvZGEiLCJhIjoiY2txMTE1cGl2MDVmZzJvcXVibjViMGliaCJ9.13cxlIO8hYUtM1rQuvlbBw`, {\n      headers: {\n        Accept: \"application/json\"\n      }\n    });\n    const json = await response.json();\n    const coords = json.features[0].center.reverse();\n    setSearchCoordinates(dispatch, coords);\n    console.log(coords);\n  };\n\n  const submitNewLocation = e => {\n    e.preventDefault();\n    getLocation();\n    newLocation();\n    setSearch(\"\");\n  };\n\n  const newLocation = () => {\n    var map = new mapboxgl.Map({\n      container: 'map',\n      style: 'mapbox://styles/mapbox/streets-v11',\n      center: [-84.4008875, 33.755288],\n      zoom: 14.5\n    });\n    let marker1 = new mapboxgl.Marker().setLngLat([-84.4008875, 33.755288]).addTo(map);\n    map.on('load', function () {\n      map.addSource('places', {\n        // This GeoJSON contains features that include an \"icon\"\n        // property. The value of the \"icon\" property corresponds\n        // to an image in the Mapbox Streets style's sprite.\n        'type': 'geojson',\n        'data': {\n          'type': 'FeatureCollection',\n          'features': allPoints\n        }\n      }); // Add a layer showing the places.\n\n      map.addLayer({\n        'id': 'places',\n        'type': 'symbol',\n        'source': 'places',\n        'layout': {\n          'icon-image': '{icon}',\n          'icon-allow-overlap': true\n        }\n      }); // When a click event occurs on a feature in the places layer, open a popup at the\n      // location of the feature, with description HTML from its properties.\n\n      map.on('click', 'places', function (e) {\n        var coordinates = e.features[0].geometry.coordinates.slice();\n        var description = e.features[0].properties.description; // Ensure that if the map is zoomed out such that multiple\n        // copies of the feature are visible, the popup appears\n        // over the copy being pointed to.\n\n        while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {\n          coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;\n        }\n\n        new mapboxgl.Popup().setLngLat(coordinates).setHTML(description).addTo(map);\n      }); // Change the cursor to a pointer when the mouse is over the places layer.\n\n      map.on('mouseenter', 'places', function () {\n        map.getCanvas().style.cursor = 'pointer';\n      }); // Change it back to a pointer when it leaves.\n\n      map.on('mouseleave', 'places', function () {\n        map.getCanvas().style.cursor = '';\n      });\n    });\n  }; // \tconst newLocation = () => {\n  // \t\tif (searchCoordinates[1]) {\n  // \t\t\tvar map = new mapboxgl.Map({\n  // \t\t\tcontainer: 'map',\n  // \t\t\tstyle: 'mapbox://styles/mapbox/streets-v11',\n  // \t\t\tcenter: [searchCoordinates[1], searchCoordinates[0]],\n  // \t\t\tzoom: 14.5\n  // \t\t\t});\n  // \t\t\tlet marker1 = new mapboxgl.Marker()\n  // \t\t\t.setLngLat([searchCoordinates[1], searchCoordinates[0]])\n  // \t\t\t.addTo(map);\n  // \t\t\tmap.on('load', function () {\n  // \t\t\t\tmap.addSource('places', {\n  // \t\t\t\t// This GeoJSON contains features that include an \"icon\"\n  // \t\t\t\t// property. The value of the \"icon\" property corresponds\n  // \t\t\t\t// to an image in the Mapbox Streets style's sprite.\n  // \t\t\t\t'type': 'geojson',\n  // \t\t\t\t'data': {\n  // \t\t\t\t'type': 'FeatureCollection',\n  // \t\t\t\t'features': `${dbDrivewayList.map((driveway) => ({\n  // \t\t\t\t\t'type': 'Feature',\n  // \t\t\t\t\t'properties': {\n  // \t\t\t\t\t'description':\n  // \t\t\t\t\t`<strong>${driveway.address}</strong><p><a href=\"http://www.mtpleasantdc.com/makeitmtpleasant\" target=\"_blank\" title=\"Opens in a new window\">View More</a></p>`,\n  // \t\t\t\t\t'icon': 'veterinary-15'\n  // \t\t\t\t\t},\n  // \t\t\t\t\t'geometry': {\n  // \t\t\t\t\t'type': 'Point',\n  // \t\t\t\t\t'coordinates': `${driveway.lat_long}`\n  // \t\t\t\t\t}\n  // \t\t\t\t\t}))}`\n  // \t\t\t\t}\n  // \t\t\t\t});\n  // \t\t\t\t// Add a layer showing the places.\n  // \t\t\t\tmap.addLayer({\n  // \t\t\t\t'id': 'places',\n  // \t\t\t\t'type': 'symbol',\n  // \t\t\t\t'source': 'places',\n  // \t\t\t\t'layout': {\n  // \t\t\t\t'icon-image': '{icon}',\n  // \t\t\t\t'icon-allow-overlap': true\n  // \t\t\t\t}\n  // \t\t\t\t});\n  // \t\t\t\t// When a click event occurs on a feature in the places layer, open a popup at the\n  // \t\t\t\t// location of the feature, with description HTML from its properties.\n  // \t\t\t\tmap.on('click', 'places', function (e) {\n  // \t\t\t\tvar coordinates = e.features[0].geometry.coordinates.slice();\n  // \t\t\t\tvar description = e.features[0].properties.description;\n  // \t\t\t\t// Ensure that if the map is zoomed out such that multiple\n  // \t\t\t\t// copies of the feature are visible, the popup appears\n  // \t\t\t\t// over the copy being pointed to.\n  // \t\t\t\twhile (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {\n  // \t\t\t\tcoordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;\n  // \t\t\t\t}\n  // \t\t\t\tnew mapboxgl.Popup()\n  // \t\t\t\t.setLngLat(coordinates)\n  // \t\t\t\t.setHTML(description)\n  // \t\t\t\t.addTo(map);\n  // \t\t\t\t});\n  // \t\t\t\t// Change the cursor to a pointer when the mouse is over the places layer.\n  // \t\t\t\tmap.on('mouseenter', 'places', function () {\n  // \t\t\t\tmap.getCanvas().style.cursor = 'pointer';\n  // \t\t\t\t});\n  // \t\t\t\t// Change it back to a pointer when it leaves.\n  // \t\t\t\tmap.on('mouseleave', 'places', function () {\n  // \t\t\t\tmap.getCanvas().style.cursor = '';\n  // \t\t\t\t});\n  // \t\t\t\t})}\n  // \t\t;\t\n  // };\n\n\n  useEffect(() => {\n    newLocation();\n    getDrivewayData();\n  }, [searchCoordinates]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"driveway-results-div\",\n      children: [/*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: submitNewLocation,\n        className: \"results-search-bar\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"landing-search-input\",\n          type: \"search\",\n          placeholder: \"Input new destination\",\n          value: search,\n          onChange: e => setSearch(e.target.value),\n          required: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          id: \"main-search-button\",\n          children: \"Search\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 238,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Search Results\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"results-and-map\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"search-results\",\n          children: dbDrivewayList.length > 1 ? dbDrivewayList.map(driveway => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: classes.root,\n            children: /*#__PURE__*/_jsxDEV(Paper, {\n              elevation: 3,\n              children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                className: \"driveway-pic\",\n                src: emptyDriveway,\n                alt: \"driveway\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 247,\n                columnNumber: 11\n              }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n                children: driveway.address\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 252,\n                columnNumber: 11\n              }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 253,\n                columnNumber: 11\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [\"$\", driveway.rate, \" / hour\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 254,\n                columnNumber: 11\n              }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 255,\n                columnNumber: 11\n              }, this), /*#__PURE__*/_jsxDEV(Link, {\n                to: `/driveway/${driveway.id}`,\n                children: \"More\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 256,\n                columnNumber: 11\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 246,\n              columnNumber: 10\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 245,\n            columnNumber: 9\n          }, this)) : /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"No results!\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 261,\n            columnNumber: 8\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"map\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 5\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 4\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 227,\n    columnNumber: 3\n  }, this);\n}\n\n_s(DrivewayResults, \"Nu44rPKLAALlvhpaba4kV3s5VvA=\", false, function () {\n  return [useSelector, useSelector, useDispatch, useStyles, useHistory];\n});\n\n_c = DrivewayResults;\n\nvar _c;\n\n$RefreshReg$(_c, \"DrivewayResults\");","map":{"version":3,"sources":["/home/groves/code/parking-pals/client/src/components/DrivewayResults.jsx"],"names":["React","useRef","useEffect","useState","useSelector","useDispatch","makeStyles","Paper","emptyDriveway","Link","useHistory","mapboxgl","setSearchCoordinates","dbDriveways","accessToken","useStyles","theme","root","display","flexWrap","margin","spacing","width","height","DrivewayResults","searchCoordinates","state","dbDrivewayList","lng","setLng","lat","setLat","zoom","setZoom","search","setSearch","dispatch","classes","history","getDrivewayData","response","fetch","method","parsedData","json","allPoints","map","point","type","properties","description","address","geometry","coordinates","lat_long","getLocation","headers","Accept","coords","features","center","reverse","console","log","submitNewLocation","e","preventDefault","newLocation","Map","container","style","marker1","Marker","setLngLat","addTo","on","addSource","addLayer","slice","Math","abs","lngLat","Popup","setHTML","getCanvas","cursor","target","value","length","driveway","rate","id"],"mappings":"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","sourcesContent":["import React, { useRef, useEffect, useState } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Paper from \"@material-ui/core/Paper\";\nimport emptyDriveway from \"../assets/images/emptydriveway.png\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport mapboxgl from \"!mapbox-gl\"; // eslint-disable-line import/no-webpack-loader-syntax\nimport \"../css/DrivewayResults.css\";\nimport { setSearchCoordinates } from \"../actions/search-actions\";\nimport { dbDriveways } from \"../actions/db-driveways-actions\";\n\nmapboxgl.accessToken =\n\t\"pk.eyJ1Ijoid3N2b2JvZGEiLCJhIjoiY2txMTE1cGl2MDVmZzJvcXVibjViMGliaCJ9.13cxlIO8hYUtM1rQuvlbBw\";\n\nconst useStyles = makeStyles((theme) => ({\n\troot: {\n\t\tdisplay: \"flex\",\n\t\tflexWrap: \"wrap\",\n\t\t\"& > *\": {\n\t\t\tmargin: theme.spacing(1),\n\t\t\twidth: theme.spacing(32),\n\t\t\theight: theme.spacing(32),\n\t\t},\n\t\tmargin: \"auto\",\n\t},\n}));\n\nexport default function DrivewayResults() {\n\tconst searchCoordinates = useSelector((state) => state.searchCoordinates);\n\tconst dbDrivewayList = useSelector((state) => state.dbDrivewayList);\n\tconst [lng, setLng] = useState(-84.4);\n\tconst [lat, setLat] = useState(33.755);\n\tconst [zoom, setZoom] = useState(14);\n\tconst [search, setSearch] = useState(\"\");\n\tconst dispatch = useDispatch();\n\tconst classes = useStyles();\n\tconst history = useHistory();\n\n\tconst getDrivewayData = async () => {\n\t\tconst response = await fetch(\"http://localhost:3001/api/driveways\", {\n\t\t\tmethod: \"GET\",\n\t\t});\n\t\tconst parsedData = await response.json();\n\t\tdbDriveways(dispatch, parsedData);\n\t\tconst allPoints = dbDrivewayList.map(point => ({\n\t\t\ttype: 'Feature',\n\t\t\tproperties: {\n\t\t\tdescription:\n\t\t\t\t`<strong>${point.address}</strong><p><a href=\"http://www.mtpleasantdc.com/makeitmtpleasant\" target=\"_blank\" title=\"Opens in a new window\">View More</a></p>`,\n\t\t\t\t'icon': 'veterinary-15'\n\t\t\t\t},\n\t\t\t\tgeometry: {\n\t\t\t\ttype: 'Point',\n\t\t\t\tcoordinates: point.lat_long\n\t\t\t\t}\n\t\t}))\n\t\treturn allPoints\n\t};\n\n\tconst getLocation = async () => {\n\t\tconst response = await fetch(\n\t\t\t`https://api.mapbox.com/geocoding/v5/mapbox.places/${search}.json?&access_token=pk.eyJ1Ijoid3N2b2JvZGEiLCJhIjoiY2txMTE1cGl2MDVmZzJvcXVibjViMGliaCJ9.13cxlIO8hYUtM1rQuvlbBw`,\n\t\t\t{\n\t\t\t\theaders: { Accept: \"application/json\" },\n\t\t\t}\n\t\t);\n\t\tconst json = await response.json();\n\t\tconst coords = json.features[0].center.reverse();\n\t\tsetSearchCoordinates(dispatch, coords);\n\t\tconsole.log(coords);\n\t};\n\tconst submitNewLocation = (e) => {\n\t\te.preventDefault();\n\t\tgetLocation();\n\t\tnewLocation();\n\t\tsetSearch(\"\");\n\t};\n\n\tconst newLocation = () => {\n\t\t\tvar map = new mapboxgl.Map({\n\t\t\t\tcontainer: 'map',\n\t\t\t\tstyle: 'mapbox://styles/mapbox/streets-v11',\n\t\t\t\tcenter: [-84.4008875\n\t\t\t\t\t, 33.755288\n\t\t\t\t],\n\t\t\t\tzoom: 14.5\n\t\t\t\t});\n\t\t\t\tlet marker1 = new mapboxgl.Marker()\n\t\t\t\t.setLngLat([-84.4008875, 33.755288])\n\t\t\t\t.addTo(map);\n\n\t\t\t\tmap.on('load', function () {\n\t\t\t\t\tmap.addSource('places', {\n\t\t\t\t\t// This GeoJSON contains features that include an \"icon\"\n\t\t\t\t\t// property. The value of the \"icon\" property corresponds\n\t\t\t\t\t// to an image in the Mapbox Streets style's sprite.\n\t\t\t\t\t'type': 'geojson',\n\t\t\t\t\t'data': {\n\t\t\t\t\t'type': 'FeatureCollection',\n\t\t\t\t\t'features': allPoints\n\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t// Add a layer showing the places.\n\t\t\t\t\tmap.addLayer({\n\t\t\t\t\t'id': 'places',\n\t\t\t\t\t'type': 'symbol',\n\t\t\t\t\t'source': 'places',\n\t\t\t\t\t'layout': {\n\t\t\t\t\t'icon-image': '{icon}',\n\t\t\t\t\t'icon-allow-overlap': true\n\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t \n\t\t\t\t\t// When a click event occurs on a feature in the places layer, open a popup at the\n\t\t\t\t\t// location of the feature, with description HTML from its properties.\n\t\t\t\t\tmap.on('click', 'places', function (e) {\n\t\t\t\t\tvar coordinates = e.features[0].geometry.coordinates.slice();\n\t\t\t\t\tvar description = e.features[0].properties.description;\n\t\t\t\t\t \n\t\t\t\t\t// Ensure that if the map is zoomed out such that multiple\n\t\t\t\t\t// copies of the feature are visible, the popup appears\n\t\t\t\t\t// over the copy being pointed to.\n\t\t\t\t\twhile (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {\n\t\t\t\t\tcoordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;\n\t\t\t\t\t}\n\t\t\t\t\t \n\t\t\t\t\tnew mapboxgl.Popup()\n\t\t\t\t\t.setLngLat(coordinates)\n\t\t\t\t\t.setHTML(description)\n\t\t\t\t\t.addTo(map);\n\t\t\t\t\t});\n\t\t\t\t\t \n\t\t\t\t\t// Change the cursor to a pointer when the mouse is over the places layer.\n\t\t\t\t\tmap.on('mouseenter', 'places', function () {\n\t\t\t\t\tmap.getCanvas().style.cursor = 'pointer';\n\t\t\t\t\t});\n\t\t\t\t\t \n\t\t\t\t\t// Change it back to a pointer when it leaves.\n\t\t\t\t\tmap.on('mouseleave', 'places', function () {\n\t\t\t\t\tmap.getCanvas().style.cursor = '';\n\t\t\t\t\t});\n\t\t\t\t\t});\t\n\t};\n\n// \tconst newLocation = () => {\n// \t\tif (searchCoordinates[1]) {\n// \t\t\tvar map = new mapboxgl.Map({\n// \t\t\tcontainer: 'map',\n// \t\t\tstyle: 'mapbox://styles/mapbox/streets-v11',\n// \t\t\tcenter: [searchCoordinates[1], searchCoordinates[0]],\n// \t\t\tzoom: 14.5\n// \t\t\t});\n// \t\t\tlet marker1 = new mapboxgl.Marker()\n// \t\t\t.setLngLat([searchCoordinates[1], searchCoordinates[0]])\n// \t\t\t.addTo(map);\n// \t\t\tmap.on('load', function () {\n// \t\t\t\tmap.addSource('places', {\n// \t\t\t\t// This GeoJSON contains features that include an \"icon\"\n// \t\t\t\t// property. The value of the \"icon\" property corresponds\n// \t\t\t\t// to an image in the Mapbox Streets style's sprite.\n// \t\t\t\t'type': 'geojson',\n// \t\t\t\t'data': {\n// \t\t\t\t'type': 'FeatureCollection',\n// \t\t\t\t'features': `${dbDrivewayList.map((driveway) => ({\n// \t\t\t\t\t'type': 'Feature',\n// \t\t\t\t\t'properties': {\n// \t\t\t\t\t'description':\n// \t\t\t\t\t`<strong>${driveway.address}</strong><p><a href=\"http://www.mtpleasantdc.com/makeitmtpleasant\" target=\"_blank\" title=\"Opens in a new window\">View More</a></p>`,\n// \t\t\t\t\t'icon': 'veterinary-15'\n// \t\t\t\t\t},\n// \t\t\t\t\t'geometry': {\n// \t\t\t\t\t'type': 'Point',\n// \t\t\t\t\t'coordinates': `${driveway.lat_long}`\n// \t\t\t\t\t}\n// \t\t\t\t\t}))}`\n// \t\t\t\t}\n// \t\t\t\t});\n// \t\t\t\t// Add a layer showing the places.\n// \t\t\t\tmap.addLayer({\n// \t\t\t\t'id': 'places',\n// \t\t\t\t'type': 'symbol',\n// \t\t\t\t'source': 'places',\n// \t\t\t\t'layout': {\n// \t\t\t\t'icon-image': '{icon}',\n// \t\t\t\t'icon-allow-overlap': true\n// \t\t\t\t}\n// \t\t\t\t});\n\t\t\t\t \n// \t\t\t\t// When a click event occurs on a feature in the places layer, open a popup at the\n// \t\t\t\t// location of the feature, with description HTML from its properties.\n// \t\t\t\tmap.on('click', 'places', function (e) {\n// \t\t\t\tvar coordinates = e.features[0].geometry.coordinates.slice();\n// \t\t\t\tvar description = e.features[0].properties.description;\n\t\t\t\t \n// \t\t\t\t// Ensure that if the map is zoomed out such that multiple\n// \t\t\t\t// copies of the feature are visible, the popup appears\n// \t\t\t\t// over the copy being pointed to.\n// \t\t\t\twhile (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {\n// \t\t\t\tcoordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;\n// \t\t\t\t}\n\t\t\t\t \n// \t\t\t\tnew mapboxgl.Popup()\n// \t\t\t\t.setLngLat(coordinates)\n// \t\t\t\t.setHTML(description)\n// \t\t\t\t.addTo(map);\n// \t\t\t\t});\n\t\t\t\t \n// \t\t\t\t// Change the cursor to a pointer when the mouse is over the places layer.\n// \t\t\t\tmap.on('mouseenter', 'places', function () {\n// \t\t\t\tmap.getCanvas().style.cursor = 'pointer';\n// \t\t\t\t});\n\t\t\t\t \n// \t\t\t\t// Change it back to a pointer when it leaves.\n// \t\t\t\tmap.on('mouseleave', 'places', function () {\n// \t\t\t\tmap.getCanvas().style.cursor = '';\n// \t\t\t\t});\n// \t\t\t\t})}\n// \t\t;\t\n// };\n\n\tuseEffect(() => {\n\t\tnewLocation();\n\t\tgetDrivewayData();\n\t}, [searchCoordinates]);\n\n\treturn (\n\t\t<div>\n\t\t\t<div className=\"driveway-results-div\">\n\t\t\t\t<form onSubmit={submitNewLocation} className=\"results-search-bar\">\n\t\t\t\t\t<input\n\t\t\t\t\t\tid=\"landing-search-input\"\n\t\t\t\t\t\ttype=\"search\"\n\t\t\t\t\t\tplaceholder=\"Input new destination\"\n\t\t\t\t\t\tvalue={search}\n\t\t\t\t\t\tonChange={(e) => setSearch(e.target.value)}\n\t\t\t\t\t\trequired\n\t\t\t\t\t/>\n\t\t\t\t\t<button id=\"main-search-button\">Search</button>\n\t\t\t\t</form>\n\t\t\t\t<h1>Search Results</h1>\n\t\t\t\t<div className=\"results-and-map\">\n\t\t\t\t\t<div className=\"search-results\">\n\t\t\t\t\t\t{dbDrivewayList.length > 1 ? (\n\t\t\t\t\t\t\tdbDrivewayList.map((driveway) => (\n\t\t\t\t\t\t\t\t<div className={classes.root}>\n\t\t\t\t\t\t\t\t\t<Paper elevation={3}>\n\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"driveway-pic\"\n\t\t\t\t\t\t\t\t\t\t\tsrc={emptyDriveway}\n\t\t\t\t\t\t\t\t\t\t\talt=\"driveway\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t<h2>{driveway.address}</h2>\n\t\t\t\t\t\t\t\t\t\t<br></br>\n\t\t\t\t\t\t\t\t\t\t<p>${driveway.rate} / hour</p>\n\t\t\t\t\t\t\t\t\t\t<br></br>\n\t\t\t\t\t\t\t\t\t\t<Link to={`/driveway/${driveway.id}`}>More</Link>\n\t\t\t\t\t\t\t\t\t</Paper>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t))\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<p>No results!</p>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t<div id=\"map\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n"]},"metadata":{},"sourceType":"module"}